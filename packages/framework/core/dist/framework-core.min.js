/*!
 * @cdp/framework-core 0.9.0
 *   core framework
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t=t||self,e(t.CDP=t.CDP||{}))}(this,(function(t){"use strict";function e(){return"object"==typeof globalThis?globalThis:Function("return this")()}function n(){const t=e();return t.CDP&&t.CDP.Config||(t.CDP=t.CDP||{},t.CDP.Config=t.Config||{}),t.CDP.Config}function r(t){return null!=t}function s(t){return null==t}function o(t){return"string"==typeof t}function i(t){return"number"==typeof t}function c(t){return"symbol"==typeof t}const a=Array.isArray;function u(t){return Boolean(t)&&"object"==typeof t}function l(t){return!!u(t)&&(!Object.getPrototypeOf(t)||d(Object,t))}function f(t){if(!l(t))return!1;for(const e in t)return!1;return!0}function h(t){return"function"==typeof t}function p(t){return Symbol.iterator in Object(t)}const y={Int8Array:!0,Uint8Array:!0,Uint8ClampedArray:!0,Int16Array:!0,Uint16Array:!0,Int32Array:!0,Uint32Array:!0,Float32Array:!0,Float64Array:!0};function b(t){return!!y[g(t)]}function d(t,e){return null!=e&&"function"==typeof t&&Object.getPrototypeOf(e)===Object(t.prototype)}function g(t){if(null!=t){const e=t[Symbol.toStringTag];if(o(e))return e;if(h(t)&&t.prototype&&null!=t.name)return t.name;{const e=t.constructor;if(h(e)&&e===Object(e.prototype).constructor)return e.name}}return Object.prototype.toString.call(t).slice(8,-1)}function O(t,e){return null==t&&null==e?g(t)===g(e):null!=t&&null!=e&&Object.getPrototypeOf(t)===Object.getPrototypeOf(e)}const m={notNil:(t,e)=>{if(null==t)throw r(e)||(e=`${g(t)} is not a valid value.`),new TypeError(e)},typeOf:(t,e,n)=>{if(typeof e!==t)throw r(n)||(n=`Type of ${g(e)} is not ${t}.`),new TypeError(n)},array:(t,e)=>{if(!a(t))throw r(e)||(e=`${g(t)} is not an Array.`),new TypeError(e)},iterable:(t,e)=>{if(!(Symbol.iterator in Object(t)))throw r(e)||(e=`${g(t)} is not an iterable object.`),new TypeError(e)},instanceOf:(t,e,n)=>{if(!(e instanceof t))throw r(n)||(n=`${g(e)} is not an instance of ${t.name}.`),new TypeError(n)},ownInstanceOf:(t,e,n)=>{if(null==e||Object.getPrototypeOf(e)!==Object(t.prototype))throw r(n)||(n=`The object is not own instance of ${t.name}.`),new TypeError(n)},notOwnInstanceOf:(t,e,n)=>{if(null!=e&&Object.getPrototypeOf(e)===Object(t.prototype))throw r(n)||(n=`The object is own instance of ${t.name}.`),new TypeError(n)},hasProperty:(t,e,n)=>{if(null==t||!(e in t))throw r(n)||(n=`The object does not have property ${String(e)}.`),new TypeError(n)},hasOwnProperty:(t,e,n)=>{if(null==t||!Object.prototype.hasOwnProperty.call(t,e))throw r(n)||(n=`The object does not have own property ${String(e)}.`),new TypeError(n)}};function w(t,...e){m[t](...e)}function E(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(!_(t[r],e[r]))return!1;return!0}function S(t,e){const n=t.byteLength;if(n!==e.byteLength)return!1;let r=0;if(n-r>=8){const s=n>>>3,o=new Float64Array(t,0,s),i=new Float64Array(e,0,s);for(let t=0;t<s;t++)if(!Object.is(o[t],i[t]))return!1;r=s<<3}if(r===n)return!0;const s=new DataView(t),o=new DataView(e);if(n-r>=4){if(!Object.is(s.getUint32(r),o.getUint32(r)))return!1;r+=4}if(n-r>=2){if(!Object.is(s.getUint16(r),o.getUint16(r)))return!1;r+=2}if(n>r){if(!Object.is(s.getUint8(r),o.getUint8(r)))return!1;r+=1}return r===n}function _(t,e){if(t===e)return!0;if(h(t)&&h(e))return t.length===e.length&&t.name===e.name;if(!u(t)||!u(e))return!1;{const n=t.valueOf(),r=e.valueOf();if(t!==n||e!==r)return n===r}{const n=t instanceof RegExp,r=e instanceof RegExp;if(n||r)return n===r&&String(t)===String(e)}{const n=a(t),r=a(e);if(n||r)return n===r&&E(t,e)}{const n=t instanceof ArrayBuffer,r=e instanceof ArrayBuffer;if(n||r)return n===r&&S(t,e)}{const n=ArrayBuffer.isView(t),r=ArrayBuffer.isView(e);if(n||r)return n===r&&O(t,e)&&S(t.buffer,e.buffer)}{const n=p(t),r=p(e);if(n||r)return n===r&&E([...t],[...e])}if(O(t,e)){const n=new Set(Object.keys(t)),r=new Set(Object.keys(e));if(n.size!==r.size)return!1;for(const t of n)if(!r.has(t))return!1;for(const r of n)if(!_(t[r],e[r]))return!1}else{for(const n in t)if(!(n in e))return!1;const n=new Set;for(const r in e){if(!(r in t))return!1;n.add(r)}for(const r of n)if(!_(t[r],e[r]))return!1}return!0}function P(t){const e=new ArrayBuffer(t.byteLength);return new Uint8Array(e).set(new Uint8Array(t)),e}function C(t,e){if(void 0===e||t===e)return t;if(!u(e))return e;if(e.valueOf()!==e)return _(t,e)?t:new e.constructor(e.valueOf());if(e instanceof RegExp)return _(t,e)?t:function n(t){const e=new RegExp(t.source,t.flags);return e.lastIndex=t.lastIndex,e}(e);if(e instanceof ArrayBuffer)return _(t,e)?t:P(e);if(ArrayBuffer.isView(e))return _(t,e)?t:b(e)?function r(t){const e=P(t.buffer);return new t.constructor(e,t.byteOffset,t.length)}(e):function s(t){const e=P(t.buffer);return new DataView(e,t.byteOffset,t.byteLength)}(e);if(Array.isArray(e))return function o(t,e){for(let n=0,r=e.length;n<r;n++){const r=t[n],s=C(r,e[n]);r===s||(t[n]=s)}return t}(a(t)?t:[],e);if(e instanceof Set)return function i(t,e){for(const n of e)t.has(n)||t.add(C(void 0,n));return t}(t instanceof Set?t:new Set,e);if(e instanceof Map)return function c(t,e){for(const[n,r]of e){const e=t.get(n),s=C(e,r);e===s||t.set(n,s)}return t}(t instanceof Map?t:new Map,e);const l=u(t)?t:{};if(O(t,e))for(const t of Object.keys(e)){const n=l[t],r=C(n,e[t]);n===r||(l[t]=r)}else for(const t in e){const n=l[t],r=C(n,e[t]);n===r||(l[t]=r)}return l}function v(t,...e){let n=t;for(const t of e)n=C(n,t);return n}function j(t){return v(void 0,t)}const R=Object.prototype,A=Function.prototype[Symbol.hasInstance],D=Symbol("override"),T=Symbol("isInherited"),M=Symbol("constructors"),k=Symbol("classBase"),x=Symbol("classSources"),L=Symbol("protoExtendsOnly");function I(t,e){e&&Object.getOwnPropertyNames(e).filter(t=>!/(prototype|name|constructor)/.test(t)).forEach(n=>{null==t[n]&&Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}function U(t,e){const n=e||(null===e?void 0:e=>Object.prototype.isPrototypeOf.call(t.prototype,e)),r=n&&Object.getOwnPropertyDescriptor(t,D);r||Object.defineProperties(t,{[Symbol.hasInstance]:{value:n,writable:!0,enumerable:!1},[D]:{value:!!n||void 0,writable:!0}})}const N=Math.random.bind(Math);async function $(t,e,n){return Promise.all(t.map(async(t,r,s)=>await e.call(n||this,t,r,s)))}const z=new Proxy((function B(){return z}),{get:(t,e)=>{const n=t[e];return null!=n?n:z}});function F(t){return t||function e(){const t=new Proxy({},{get:(t,e)=>{const n=t[e];return null!=n?n:z}});return Object.defineProperty(t,"stub",{value:!0,writable:!1}),t}()}const K=e(),V=F(K.setTimeout),G=F(K.clearTimeout),W=F(K.setInterval),q=F(K.clearInterval);function H(t){return Promise.resolve().then(t)}function J(t){const e=e=>t[e],n=`(?:${Object.keys(t).join("|")})`,r=RegExp(n),s=RegExp(n,"g");return t=>(t=null==t||"symbol"==typeof t?"":String(t),r.test(t)?t.replace(s,e):t)}const Z=J({"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","`":"&#x60;"});function Q(t){return void 0===t||o(t)?t:u(t)?JSON.stringify(t):String(t)}function X(t,e=!1){return null!=t?t:e?String(t):null}function Y(t){return"null"===t?null:"undefined"===t?void 0:t}function tt(t,e=!1){const n=e?t.slice(1).toLowerCase():t.slice(1);return t.charAt(0).toUpperCase()+n}function et(t){return t.charAt(0).toLowerCase()+t.slice(1)}function nt(t,e=!1){return t=t.trim().replace(/[-_\s]+(.)?/g,(t,e)=>e?e.toUpperCase():""),!0===e?et(t):t}const rt=new WeakMap;function st(t){if(!rt.has(t))throw new TypeError("This is not a valid EventPublisher.");return rt.get(t)}function ot(t){if(!o(t)&&!c(t))throw new TypeError(`Type of ${g(t)} is not a valid channel.`)}function it(t){return null!=t&&w("typeOf","function",t),t}class ct{constructor(){w("instanceOf",ct,this),rt.set(this,new Map)}publish(t,...e){const n=st(this);ot(t);const r=n.get(t);if(r)for(const t of r)try{const n=t(...e);if(!0===n)break}catch(t){Promise.reject(t)}}has(t,e){const n=st(this);if(null==t)return n.size>0;if(ot(t),null==e)return n.has(t);it(e);const r=n.get(t);return!!r&&r.has(e)}channels(){return[...st(this).keys()]}off(t,e){const n=st(this);if(null==t)return n.clear(),void 0;const r=a(t)?t:[t],s=it(e);for(const t of r)if(ot(t),null!=s){const e=n.get(t);e&&(e.delete(s),e.size>0||n.delete(t))}else n.delete(t)}on(t,e){const n=st(this);it(e);const r=a(t)?t:[t];for(const t of r)ot(t),n.has(t)?n.get(t).add(e):n.set(t,new Set([e]));return Object.freeze({get enable(){for(const t of r){const r=n.get(t);if(!r||!r.has(e))return this.unsubscribe(),!1}return!0},unsubscribe(){for(const t of r){const r=n.get(t);r&&(r.delete(e),r.size>0||n.delete(t))}}})}once(t,e){const n=this.on(t,e),r=this.on(t,()=>{n.unsubscribe(),r.unsubscribe()});return n}}const at=ct,ut=Symbol("cancel"),lt=Symbol("close"),ft=Object.freeze({enable:!1,unsubscribe(){}}),ht=new WeakMap;function pt(t){if(!ht.has(t))throw new TypeError("The object is not a valid CancelToken.");return ht.get(t)}class yt{static source(...t){let e,n;const r=new yt((t,r)=>{e=t,n=r},...t);return Object.freeze({token:r,cancel:e,close:n})}constructor(t,...e){w("instanceOf",yt,this),w("typeOf","function",t);const n=new Set(e.filter(t=>ht.has(t)));let r=0;for(const t of n)r|=pt(t).status;const s={publisher:new at,subscriptions:new Set,reason:void 0,status:r};ht.set(this,Object.seal(s));const o=this[ut],i=this[lt];if(0===r)for(const t of n)s.subscriptions.add(t.register(o.bind(this))),this.register(o.bind(t));t(o.bind(this),i.bind(this))}get reason(){return pt(this).reason}get cancelable(){return 0===pt(this).status}get requested(){return!!(1&pt(this).status)}get closed(){return!!(2&pt(this).status)}get[Symbol.toStringTag](){return"CancelToken"}register(t){const e=pt(this);return this.cancelable?e.publisher.on("cancel",t):ft}[ut](t){const e=pt(this);if(w("notNil",t),this.cancelable){e.reason=t,e.status|=1;for(const t of e.subscriptions)t.unsubscribe();e.publisher.publish("cancel",t),Promise.resolve().then(()=>this[lt]())}}[lt](){const t=pt(this);if(!this.closed){t.status|=2;for(const e of t.subscriptions)e.unsubscribe();t.subscriptions.clear(),t.publisher.off()}}}const bt=Promise,dt=Symbol("create"),gt=new WeakMap;class Ot extends bt{static get[Symbol.species](){return bt}static resolve(t,e){return this[dt](super.resolve(t),e)}static[dt](t,e,n){let r;if(w("instanceOf",bt,t),e instanceof yt)if(!n||h(n[0])&&!h(n[1]))if(e.cancelable){let n;r=new bt((r,s)=>{n=e.register(s),super.prototype.then.call(t,r,s)});const s=()=>{n.unsubscribe(),gt.delete(r)};r.then(s,s)}else if(e.requested)r=super.reject(e.reason);else{if(!e.closed)throw new Error("Unexpected Exception");r=t}else r=t;else r=t;return n&&(r=super.prototype.then.apply(r,n)),e&&e.cancelable&&gt.set(r,e),r instanceof this||Object.setPrototypeOf(r,this.prototype),r}constructor(t,e){return super(t),Ot[dt](this,e)}then(t,e){return Ot[dt](this,gt.get(this),[t,e])}catch(t){return this.then(void 0,t)}finally(t){return Ot[dt](super.finally(t),gt.get(this))}}function mt(t){return Promise=t?Ot:bt,Promise}function wt(t){const e=t.map(t=>t.catch(t=>t));return Promise.all(e)}function Et(t){return Promise.resolve(void 0,t)}mt(!n().noAutomaticNativeExtend);const St=/(abort|cancel)/im;class _t{get(){return this._broker||(this._broker=new at)}}const Pt=Symbol("internal"),Ct=Symbol("notify"),vt=Symbol("stock-change"),jt=Symbol("notify-changes");function Rt(t){if(!t||!t[Pt])throw new TypeError("The object passed is not an IObservable.")}const At={set(t,e,n,r){if(!o(e))return Reflect.set(t,e,n,r);const s=t[e];return"disabled"!==t[Pt].state&&n!==s&&t[vt](e,s),Reflect.set(t,e,n,r)}};Object.freeze(At);class Dt{constructor(t="active"){w("instanceOf",Dt,this);const e={state:t,changeMap:new Map,broker:new _t};return Object.defineProperty(this,Pt,{value:Object.seal(e)}),new Proxy(this,At)}on(t,e){Rt(this);const{changeMap:n,broker:r}=this[Pt],s=r.get().on(t,e);if(0<n.size){const e=a(t)?t:[t];for(const t of e)n.has(t)||n.set(t,this[t])}return s}off(t,e){Rt(this),this[Pt].broker.get().off(t,e)}suspend(t=!1){return Rt(this),this[Pt].state=t?"disabled":"suspended",t&&this[Pt].changeMap.clear(),this}resume(){Rt(this);const t=this[Pt];return"active"!==t.state&&(t.state="active",H(()=>this[jt]())),this}getObservableState(){return Rt(this),this[Pt].state}static from(t){const e=v(new class extends Dt{}("disabled"),t);return e.resume(),e}notify(...t){if(Rt(this),0===t.length)return;const{changeMap:e}=this[Pt],n=new Map;for(const r of t){const t=this[r],s=e.has(r)?e.get(r):t;n.set(r,[t,s])}0<n.size&&this[Ct](n)}[vt](t,e){const{state:n,changeMap:r,broker:s}=this[Pt];if(0===r.size){r.set(t,e);for(const t of s.get().channels())r.has(t)||r.set(t,this[t]);"active"===n&&H(()=>this[jt]())}else r.has(t)||r.set(t,e)}[jt](){const{state:t,changeMap:e}=this[Pt];if("active"!==t)return;const n=new Map;for(const[t,r]of e){const e=this[t];r!==e&&n.set(t,[e,r])}this[Ct](n)}[Ct](t){const{changeMap:e,broker:n}=this[Pt];e.clear();for(const[e,r]of t)n.get().publish(e,...r,e)}}const Tt={defineProperty(t,e,n){const r=t[Pt];if("disabled"===r.state||r.byMethod||!Object.prototype.hasOwnProperty.call(n,"value"))return Reflect.defineProperty(t,e,n);const s=t[e],o=n.value;if("length"===e&&o!=s){const r=s>>>0,i=o>>>0,c=()=>{const e=i<r&&t.slice(i);if(e)for(let n=r;--n>=i;)t[vt](-1,n,void 0,e[n-i]);else for(let e=r;e<i;e++)t[vt](1,e)},a=Reflect.defineProperty(t,e,n);return a&&c(),a}if(o!==s&&Mt(e)){const r=e>>>0,i=Number(r>=t.length),c=Reflect.defineProperty(t,e,n);return c&&t[vt](i,r,o,s),c}return Reflect.defineProperty(t,e,n)},deleteProperty(t,e){const n=t[Pt];if("disabled"===n.state||n.byMethod||!Object.prototype.hasOwnProperty.call(t,e))return Reflect.deleteProperty(t,e);const r=t[e],s=Reflect.deleteProperty(t,e);return s&&Mt(e)&&t[vt](0,e>>>0,void 0,r),s}};function Mt(t){const e=String(t),n=Math.trunc(e);return String(n)===e&&0<=n&&n<4294967295}Object.freeze(Tt);class kt extends Array{constructor(){super(...arguments),w("instanceOf",kt,this);const t={state:"active",byMethod:!1,records:[],indexes:new Set,broker:new _t};Object.defineProperty(this,Pt,{value:Object.seal(t)});const e=arguments.length;if(1===e&&i(arguments[0])){const t=arguments[0]>>>0;for(let e=0;e<t;e++)this[vt](1,e)}else if(0<e)for(let t=0;t<e;t++)this[vt](1,t,arguments[t]);return new Proxy(this,Tt)}on(t){return Rt(this),this[Pt].broker.get().on("@",t)}off(t){Rt(this),this[Pt].broker.get().off("@",t)}suspend(t=!1){return Rt(this),this[Pt].state=t?"disabled":"suspended",t&&(this[Pt].records=[]),this}resume(){Rt(this);const t=this[Pt];return"active"!==t.state&&(t.state="active",H(()=>this[jt]())),this}getObservableState(){return Rt(this),this[Pt].state}sort(t){Rt(this);const e=this[Pt],n=Array.from(this);e.byMethod=!0;const r=super.sort(t);if(e.byMethod=!1,"disabled"!==e.state){const t=n.length;for(let e=0;e<t;e++){const t=n[e],r=this[e];r!==t&&this[vt](0,e,r,t)}}return r}splice(t,e,...n){Rt(this);const r=this[Pt],s=this.length;r.byMethod=!0;const o=super.splice(...arguments);if(r.byMethod=!1,"disabled"!==r.state){t=Math.trunc(t);const e=t<0?Math.max(s+t,0):Math.min(t,s);for(let t=o.length;--t>=0;)this[vt](-1,e+t,void 0,o[t]);const r=n.length;for(let t=0;t<r;t++)this[vt](1,e+t,n[t])}return o}shift(){Rt(this);const t=this[Pt],e=this.length;t.byMethod=!0;const n=super.shift();return t.byMethod=!1,"disabled"!==t.state&&this.length<e&&this[vt](-1,0,void 0,n),n}unshift(...t){Rt(this);const e=this[Pt];e.byMethod=!0;const n=super.unshift(...t);if(e.byMethod=!1,"disabled"!==e.state){const e=t.length;for(let n=0;n<e;n++)this[vt](1,n,t[n])}return n}map(t,e){return kt.from([...this].map(t,e))}[vt](t,e,n,r){const{state:s,indexes:o,records:i}=this[Pt],c=o.has(e)?function a(t,e,n){const r=1===e?t=>-1===t:t=>-1!==t;for(let e=t.length;--e>=0;){const s=t[e];if(s.index===n&&r(s.type))return e;s.index<n&&Boolean(s.type)&&(n-=s.type)}return-1}(i,t,e):-1,u=i.length;if(c>=0){const r=i[c].type;if(r){for(let t,n=u;--n>c;)t=i[n],t.index>=e&&(t.index-=r);const s=i.splice(c,1)[0];-1!==t&&this[vt](Number(!t),e,n,s.oldValue)}else{const r=i.splice(c,1)[0];this[vt](t,e,n,r.oldValue)}}else o.add(e),i[u]={type:t,index:e,newValue:n,oldValue:r},"active"===s&&0===u&&H(()=>this[jt]())}[jt](){const{state:t,records:e}=this[Pt];if("active"===t&&0!==e.length){for(const t of e)Object.freeze(t);this[Ct](Object.freeze(e)),this[Pt].records=[]}}[Ct](t){const e=this[Pt];e.indexes.clear(),e.broker.get().publish("@",t)}}class xt{constructor(){this._broker=new at,this._storage={}}get kind(){return"memory"}async getItem(t,e){e=e||{},await Et(e.cancel);const n=X(this._storage[t]);switch(e.dataType){case"string":return Q(n);case"number":return Number(Y(n));case"boolean":return Boolean(Y(n));case"object":return Object(Y(n));default:return Y(n)}}async setItem(t,e,n){n=n||{},await Et(n.cancel);const r=X(e,!0),s=X(this._storage[t]);_(s,r)||(this._storage[t]=r,!n.silent&&this._broker.publish("@",t,r,s))}async removeItem(t,e){e=e||{},await Et(e.cancel);const n=this._storage[t];void 0!==n&&(delete this._storage[t],!e.silent&&this._broker.publish("@",t,null,n))}async clear(t){t=t||{},await Et(t.cancel),f(this._storage)||(this._storage={},!t.silent&&this._broker.publish("@",null,null,null))}async keys(t){return await Et(t&&t.cancel),Object.keys(this._storage)}on(t){return this._broker.on("@",t)}off(t){this._broker.off("@",t)}}const Lt=new xt;globalThis.CDP_DECLARE=globalThis.CDP_DECLARE||{},function(){let t;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.ABORT=1]="ABORT",t[t.PENDING=2]="PENDING",t[t.NOOP=3]="NOOP",t[t.FAIL=-1]="FAIL",t[t.FATAL=-2]="FATAL",t[t.NOT_SUPPORTED=-3]="NOT_SUPPORTED"}(t=CDP_DECLARE.RESULT_CODE||(CDP_DECLARE.RESULT_CODE={})),CDP_DECLARE.ASSIGN_RESULT_CODE=function e(n){Object.assign(t,n)};const n={0:"operation succeeded.",1:"operation aborted.",2:"operation pending.",3:"no operation.","-1":"operation failed.","-2":"unexpected error occured.","-3":"operation not supported."};function r(t,e,r,s){if(e<0||1e3<=e)throw new RangeError(`declareResultCode(), invalid local-code range. [code: ${e}]`);const o=s?1:-1,i=o*(t+e);return n[i]=r||`[CODE: ${i}]`,i}CDP_DECLARE.ERROR_MESSAGE_MAP=function s(){return n},CDP_DECLARE.DECLARE_SUCCESS_CODE=function o(t,e,n){return r(t,e,n,!0)},CDP_DECLARE.DECLARE_ERROR_CODE=function i(t,e,n){return r(t,e,n,!1)}}();var It=CDP_DECLARE.RESULT_CODE,Ut=CDP_DECLARE.DECLARE_SUCCESS_CODE,Nt=CDP_DECLARE.DECLARE_ERROR_CODE,$t=CDP_DECLARE.ASSIGN_RESULT_CODE,zt=CDP_DECLARE.ERROR_MESSAGE_MAP;function Bt(t){return t<0}function Ft(t){return!Bt(t)}function Kt(t,e){const n=e?`[${e}]`:"";return It[t]?`${n}[${It[t]}]`:`${n}[UNKNOWN]`}function Vt(t){const e=zt();return e[t]?e[t]:`unregistered result code. [code: ${t}]`}const Gt=Number.isFinite;class Wt extends Error{constructor(t,e,n){t=s(t)?It.SUCCESS:Gt(t)?Math.trunc(t):It.FAIL,super(e||Vt(t));let r=qt(n)?n.time:void 0;Gt(r)||(r=Date.now());const o={code:{enumerable:!0,value:t},cause:{enumerable:!0,value:n},time:{enumerable:!0,value:r}};Object.defineProperties(this,o)}get isSucceeded(){return Ft(this.code)}get isFailed(){return Bt(this.code)}get isCanceled(){return this.code===It.ABORT}get codeName(){return Kt(this.code,this.name)}get help(){return Vt(this.code)}get[Symbol.toStringTag](){return"Result"}}function qt(t){return t instanceof Error||"Error"===g(t)}Wt.prototype.name="Result",t.ASSIGN_RESULT_CODE=$t,t.CancelToken=yt,t.CancelablePromise=Ot,t.DECLARE_ERROR_CODE=Nt,t.DECLARE_SUCCESS_CODE=Ut,t.EventBroker=at,t.EventPublisher=ct,t.FAILED=Bt,t.MemoryStorage=xt,t.ObservableArray=kt,t.ObservableObject=Dt,t.Promise=Ot,t.PromiseManager=class Ht{constructor(){this._pool=new Map}add(t,e){this._pool.set(t,e&&e.cancel);const n=()=>{this._pool.delete(t),e&&e.close()};return t.then(n,n),t}release(){this._pool.clear()}promises(){return[...this._pool.keys()]}all(){return Promise.all(this.promises())}race(){return Promise.race(this.promises())}wait(){return wt(this.promises())}abort(t){for(const e of this._pool.values())e&&e(null!=t?t:new Error("abort"));return wt(this.promises())}},t.RESULT_CODE=It,t.Registry=class Jt extends ct{constructor(t,e,n){super(),this._store={},this._storage=t,this._rootKey=e,this._defaultOptions={jsonSpace:n}}get rootKey(){return this._rootKey}get storage(){return this._storage}async load(t){t=t||{},this._store=await this._storage.getItem(this._rootKey,t)||{},t.silent||H(()=>this.publish("change","*"))}async save(t){const e={...this._defaultOptions,...t};e.silent||this.publish("will-save"),await this._storage.setItem(this._rootKey,this._store,e)}read(t,e){const{field:n}=e||{},r=String(t).split("/"),s=r.pop();let o,i=this._targetRoot(n);for(;o=r.shift();){if(!(o in i))return null;i=i[o]}return null!=i[s]?j(i[s]):null}write(t,e,n){const{field:r,noSave:s,silent:o}=n||{},i=null==e,c=String(t).split("/"),a=c.pop();let u,l=this._targetRoot(r);for(;u=c.shift();)if(u in l)l=l[u];else{if(i)return;l=l[u]={}}const f=i?null:e,h=X(l[a]);_(h,f)||(i?delete l[a]:l[a]=j(f),s||this._storage.setItem(this._rootKey,this._store,{...this._defaultOptions,...n}),o||H(()=>this.publish("change",t,f,h)))}delete(t,e){this.write(t,null,e)}clear(t){t=t||{},this._store={},this._storage.removeItem(this._rootKey,t),t.silent||this.publish("change",null,null,null)}_targetRoot(t){return t?(this._store[t]=this._store[t]||{},this._store[t]):this._store}},t.Result=Wt,t.SUCCEEDED=Ft,t.camelize=nt,t.capitalize=tt,t.checkCanceled=Et,t.className=g,t.classify=function Zt(t){return tt(nt(t.replace(/[\W_]/g," ")).replace(/\s/g,""))},t.clearInterval=q,t.clearTimeout=G,t.createEscaper=J,t.dasherize=function Qt(t){return t.trim().replace(/([A-Z])/g,"-$1").replace(/[_\s]+/g,"-").toLowerCase()},t.decapitalize=et,t.deepCopy=j,t.deepEqual=_,t.deepMerge=v,t.dropUndefined=X,t.escapeHTML=Z,t.every=async function Xt(t,e,n){for(const[r,s]of t.entries())if(!await e.call(n||this,s,r,t))return!1;return!0},t.exists=r,t.extendPromise=mt,t.filter=async function Yt(t,e,n){const r=await $(t,(t,r,s)=>e.call(n||this,t,r,s));return t.filter(()=>r.shift())},t.find=async function te(t,e,n){for(const[r,s]of t.entries())if(await e.call(n||this,s,r,t))return s},t.findIndex=async function ee(t,e,n){for(const[r,s]of t.entries())if(await e.call(n||this,s,r,t))return r;return-1},t.fromTypedData=Q,t.getConfig=n,t.getGlobal=e,t.groupBy=function ne(t,e){const{keys:n,sumKeys:r,groupKey:s}=e,o=s||"items",i=r||[];i.push(o);const c=t.reduce((t,e)=>{const r=n.reduce((t,n)=>t+String(e[n]),"");if(!(r in t)){const s=n.reduce((t,n)=>(t[n]=e[n],t),{});t[r]=i.reduce((t,e)=>(t[e]=0,t),s)}const s=t[r];for(const t of i)o===t?(s[t]=s[t]||[],s[t].push(e)):s[t]+=e[t];return t},{});return Object.values(c)},t.indices=function re(t,...e){const n=[...t.keys()],r=t.length,s=[...new Set(e)].sort((t,e)=>t<e?1:-1);for(const t of s)0<=t&&t<r&&n.splice(t,1);return n},t.instanceOf=function se(t,e){return"function"==typeof t&&e instanceof t},t.isArray=a,t.isBoolean=function oe(t){return"boolean"==typeof t},t.isChancelLikeError=function ie(t){return null!=t&&(o(t)?St.test(t):!!u(t)&&St.test(t.message))},t.isEmptyObject=f,t.isFunction=h,t.isIterable=p,t.isNil=s,t.isNumber=i,t.isObject=u,t.isObservable=function ce(t){return Boolean(t&&t[Pt])},t.isPlainObject=l,t.isPrimitive=function ae(t){return!t||"function"!=typeof t&&"object"!=typeof t},t.isResult=function ue(t){return t instanceof Wt||"Result"===g(t)},t.isString=o,t.isSymbol=c,t.isTypedArray=b,t.makeCanceledResult=function le(t,e){return new Wt(It.ABORT,t,e)},t.makeResult=function fe(t,e,n){return new Wt(t,e,n)},t.map=$,t.memoryStorage=Lt,t.mixins=function he(t,...e){let n=!1;class r extends t{constructor(...r){super(...r);const s=new Map;if(this[M]=s,this[k]=t,n)for(const t of e)if(!t[L]){const e={apply:(e,n,r)=>{const s=new t(...r);I(this,s)}};s.set(t,new Proxy(t,e))}}super(t,...e){const n=this[M],r=n.get(t);return r&&(r(...e),n.set(t,null)),this}isMixedWith(t){return this.constructor!==t&&(this[k]===t||this[x].reduce((e,n)=>e||t===n,!1))}static[Symbol.hasInstance](t){return Object.prototype.isPrototypeOf.call(r.prototype,t)}[T](t){const e=this[M];if(e.has(t))return!0;for(const n of e.keys())if(Object.prototype.isPrototypeOf.call(t,n))return!0;return!1}get[x](){return[...this[M].keys()]}}for(const t of e){const e=Object.getOwnPropertyDescriptor(t,Symbol.hasInstance);if(!e||e.writable){const n=e?t[Symbol.hasInstance]:A;U(t,e=>n.call(t,e)||!(null==e||!e[T])&&e[T](t))}I(r.prototype,t.prototype);let s=Object.getPrototypeOf(t.prototype);for(;R!==s;)I(r.prototype,s),s=Object.getPrototypeOf(s);n||(n=!t[L])}return r},t.noop=function pe(...t){},t.ownInstanceOf=d,t.partialize=function ye(t,...e){if(!t||!u(t))throw new TypeError(`${g(t)} is not an object.`);return e.reduce((e,n)=>(n in t&&(e[n]=t[n]),e),{})},t.post=H,t.reduce=async function be(t,e,n){if(t.length<=0&&void 0===n)throw TypeError("Reduce of empty array with no initial value");const r=void 0!==n;let s=r?n:t[0];for(const[n,o]of t.entries())(r||0!==n)&&(s=await e(s,o,n,t));return s},t.restoreNil=Y,t.safe=F,t.sameClass=O,t.sameType=function de(t,e){return typeof t==typeof e},t.setInterval=W,t.setMixClassAttribute=function ge(t,e,n){switch(e){case"protoExtendsOnly":t[L]=!0;break;case"instanceOf":U(t,n)}},t.setTimeout=V,t.shuffle=function Oe(t,e=!1){const n=e?t:t.slice(),r=n.length;for(let t=r>0?r>>>0:0;t>1;){const e=t*N()>>>0,r=n[--t];n[t]=n[e],n[e]=r}return n},t.sleep=function me(t){return new Promise(e=>V(e,t))},t.some=async function we(t,e,n){for(const[r,s]of t.entries())if(await e.call(n||this,s,r,t))return!0;return!1},t.sort=function t(e,n,r=!1){const s=r?e:e.slice();if(s.length<2)return s;const o=t(s.splice(0,s.length>>>1),n,!0),i=t(s.splice(0),n,!0);for(;o.length&&i.length;)s.push(n(o[0],i[0])<=0?o.shift():i.shift());return s.concat(o,i)},t.toHelpString=Vt,t.toNameString=Kt,t.toResult=function Ee(t){if(t instanceof Wt){let{code:e,cause:n,time:r}=t;return e=s(e)?It.SUCCESS:Gt(e)?Math.trunc(e):It.FAIL,Gt(r)||(r=Date.now()),Reflect.defineProperty(t,"code",{enumerable:!0,value:e}),Reflect.defineProperty(t,"cause",{enumerable:!0,value:n}),Reflect.defineProperty(t,"time",{enumerable:!0,value:r}),t}{const e=Object(t),n=Gt(e.code)?e.code:t,r=o(e.message)?e.message:o(t)?t:void 0,s=qt(e.cause)?e.cause:qt(t)?t:o(t)?new Error(t):t;return new Wt(n,r,s)}},t.toTypedData=function Se(t){return"true"===t||"false"!==t&&("null"===t?null:t===String(Number(t))?Number(t):t&&/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/.test(t)?JSON.parse(t):t)},t.typeOf=function _e(t,e){return typeof e===t},t.underscored=function Pe(t){return t.trim().replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},t.verify=w,t.wait=wt,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=framework-core.min.map